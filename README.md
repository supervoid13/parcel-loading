# Parcel Loading

Консольное приложение для погрузки посылок в грузовики. Имеет дополнительный функционал. Например, получение погруженного грузовика из json файла, подсчёт посылок и т.п.

## Содержание

- [Начало работы](#начало-работы)
- [Использование](#использование)
- [Тестирование](#тестирование)

## Начало работы

1. Установите JDK 17, Maven, Docker (docker compose).
3. Клонируйте репозиторий себе на устройство:
```sh
$ git clone https://github.com/supervoid13/parcel-loading.git
```
3. Откройте проект в любой удобной для Вас среде разработки, например, IntelliJ IDEA.
4. Установите переменные среды, создав `.env` файл (в репозитории есть шаблон `.env.example`).
4. Из корня запустите приложение.  
```sh
$ docker compose up -d
```

## Использование
- ### Spring Shell
#### 1. Погрузка посылок в грузовики

Для погрузки посылок воспользуйтесь командой `load`.

```sh
$ load --mode MODE [--trucks AMOUNT] [--height HEIGHT] [--width WIDTH] (--file PATH/--parcels PARCEL1 PARCEL2 PARCEL3)
```

Параметры:  
`mode` - обязательный параметр, выбор способа погрузки (simple, effective, uniform).  
`trucks` - обязательный параметр при `--mode uniform`, в остальных случаях игнорируется.  
`height` - необязательный параметр, высота кузова грузовиков для погрузки (по умолчанию равна 6).  
`width` - необязательный параметр, ширина кузова грузовиков для погрузки (по умолчанию равна 6).  

Следующие параметры нельзя применить одновременно:  
`file` - путь к файлу с посылками.  
`parcels` - список посылок по имени (посылки указываются через пробел).

#### 2. Подсчёт посылок из файла с грузовиками

Для подсчёта посылок и отображения кузовов грузовиков воспользуйтесь командой `specify`.

```sh
$ specify --file PATH
```

#### 3. Отображение посылок

Для отображения посылок воспользуйтесь командой `parcels`.

```sh
$ parcels [--name NAME]
```

Параметры:  
`name` - необязательный параметр, используется для вывода определённой посылки по её имени (если имя не указана, выведутся все посылки).

#### 4. Создание посылок

Для создания посылки воспользуйтесь командой `create`.

```sh
$ create --name NAME --symbol SYMBOL
```

Параметры:  
`name` - обязательный параметр, определяет имя новой посылки.  
`symbol` - обязательный параметр, определяет символ новой посылки.  

После чего введите высоту формы посылки:
```sh
Enter parcel height:
```

Заполните отдельно каждый уровень:
```sh
Enter layer {layer_level}
```

#### 5. Редактирование посылок

Для редактирования посылки воспользуйтесь командой `update`.

```sh
$ update --name NAME [--newName NEW_NAME] [--newSymbol NEW_SYMBOL]
```

Параметры:  
`name` - обязательный параметр, определяет, какую посылку отредактировать.  
`newName` - необязательный параметр, устанавливает новое имя посылки.
`newSymbol` - необязательный параметр, устанавливает новый символ для посылки.

После чего введите высоту новой формы посылки:
```sh
Enter parcel height:
```

Заполните отдельно каждый уровень:
```sh
Enter layer {layer_level}
```

#### 6. Удаление посылок

Для удаления посылки воспользуйтесь командой `delete`.

```sh
$ delete --name NAME
```

Параметры:  
`name` - обязательный параметр, определяет, какую посылку удалять.

- ### REST
#### 1. Погрузка посылок в грузовики

POST localhost:8080/loading-service/load

Параметры:  
`loadingMode` - обязательный параметр, выбор способа погрузки (simple, effective, uniform).  
`parcelListMode` - обязательный параметр, выбор способа определения посылок.
`trucks` - обязательный параметр при `loadingMode=uniform`, в остальных случаях игнорируется.  
`height` - необязательный параметр, высота кузова грузовиков для погрузки (по умолчанию равна 6).  
`width` - необязательный параметр, ширина кузова грузовиков для погрузки (по умолчанию равна 6).  
В тело можно передать:  

- список посылок по форме.
- список посылок по имени.

#### 2. Подсчёт посылок из файла с грузовиками

POST localhost:8080/loading-service/specify

В тело передаются загруженные грузовики.

#### 3. Отображение посылок
- все посылки  
GET localhost:8080/loading-service/parcels
- по имени  
GET localhost:8080/loading-service/parcels/{name}

#### 4. Создание посылок

POST localhost:8080/loading-service/parcels  
В тело запроса передаётся посылка.

#### 5. Редактирование посылок

PUT localhost:8080/loading-service/parcels/{name}
В тело запроса передаются новые данные посылки.

#### 6. Удаление посылок

DELETE localhost:8080/loading-service/parcels/{name}

- ### Telegram Bot
#### 1. Погрузка посылок в грузовики

Передаётся строка:  
`load {loadingMode} {trucks} {height} {width} [name1, name2, name3]`

Параметры:  
`loadingMode` - обязательный параметр, выбор способа погрузки (simple, effective, uniform).  
`trucks` - обязательный параметр при `loadingMode=uniform`, в остальных случаях игнорируется.  
`height` - необязательный параметр, высота кузова грузовиков для погрузки (по умолчанию равна 6).  
`width` - необязательный параметр, ширина кузова грузовиков для погрузки (по умолчанию равна 6).  
Посылки передаются либо текстовых файлом с формами посылок, либо через пробел в самом сообщении.

#### 2. Подсчёт посылок из файла с грузовиками

Передаётся строка:  
`specify`  
Файл с загруженными грузовиками типа json прикрепляется к сообщению.

#### 3. Отображение посылок

Передаётся строка:  
`parcels [{name}]`  
Если `name` указано - выведется посылки с этим именем, если нет - все посылки.

#### 4. Создание посылок

Передаётся строка:  
`create {name} {symbol}`  
К сообщению прикрепляется txt файл с формой посылки.

#### 5. Редактирование посылок

Передаётся строка:  
`update {name} {symbol} {newName}`  
К сообщению прикрепляется txt файл с формой посылки.

#### 6. Удаление посылок

Передаётся строка:  
`delete {name}`  

## Тестирование

(Файлы для ручного тестирования находятся по пути `src/test/resources/manualtest`)

Проект покрыт юнит-тестами JUnit 5. Для их запуска выполните команду:

```sh
$ mvn test
```
